version: "3.8"
services:
  api:
    build: ./api
    ports:
      - "8080:8080"
    environment:
      - GEMINI_API_KEY=${GEMINI_API_KEY}
      - GEMINI_MODEL=gemini-2.5-flash
      - GEMINI_EMBEDDING_MODEL=text-embedding-004
      - GROBID_URL=http://grobid:8070
      - QDRANT_URL=http://qdrant:6333
      - EMBEDDING_DIM=768
    volumes:
      - ./data:/app/data
    depends_on:
      - grobid
      - qdrant


  grobid:
    image: grobid/grobid:latest
    ports:
      - "8070:8070"
    environment:
      - GROBID_CORS_ENABLE=true
      - GROBID_MAX_CONNECTIONS=2


  qdrant:
    image: qdrant/qdrant:latest
    ports:
      - "6333:6333"
    volumes:
      - qdrant_data:/qdrant/storage


volumes:
qdrant_data: